# レンジブレイク銘柄チャート生成機能

この機能は、既存の `Upload_WardPress.py` に追加された新機能です。レンジブレイク銘柄の株価チャートを自動生成し、WordPress記事に追加します。

## 機能概要

1. **既存機能の維持**: 従来の売買シグナル、トレンド銘柄、レンジブレイク銘柄の投稿機能はそのまま維持
2. **チャート生成の追加**: レンジブレイク銘柄の株価チャートを自動生成
3. **WordPress投稿の拡張**: 生成したチャートを既存の記事に追加して投稿

## 追加された機能

### チャート生成機能
- **対象銘柄**: Range_Brake.csvに記載されたレンジブレイク銘柄（最大10銘柄）
- **チャート内容**: 過去60日間の価格推移と出来高
- **表示要素**:
  - 終値の推移
  - 高値・安値の範囲
  - 5日・25日移動平均線
  - 出来高

### 技術仕様
- **画像形式**: PNG（高解像度300dpi）
- **埋め込み方式**: Base64エンコードでHTMLに直接埋め込み
- **日本語対応**: japanize-matplotlibで日本語フォント対応

## 使用方法

### 1. 依存関係のインストール
```bash
cd StockSignal
pip install -r requirements.txt
```

### 2. 実行
既存の `Upload_WardPress.py` を実行するだけで、チャート生成機能が自動的に動作します。

```bash
python Upload_WardPress.py
```

## 処理の流れ

1. **既存の処理**: 従来通り売買シグナル、トレンド銘柄、レンジブレイク銘柄のテーブルを生成
2. **チャート生成**: Range_Brake.csvから最大10銘柄を読み込み、各銘柄のチャートを生成
3. **投稿内容の拡張**: 生成したチャートを既存の投稿内容に追加
4. **WordPress投稿**: 拡張された内容でWordPressに投稿

## 出力例

WordPress記事には以下のセクションが追加されます：

```
<h2>レンジブレイク銘柄チャート</h2>
<p>各銘柄の株価チャートです。過去60日間の価格推移と出来高を表示しています。</p>
[各銘柄のチャート画像]
```

## エラーハンドリング

- 株価データが見つからない銘柄はスキップ
- チャート生成に失敗した銘柄はスキップ
- エラーメッセージをコンソールに出力
- チャート生成に失敗しても既存の投稿機能は正常に動作

## カスタマイズ

### チャート生成銘柄数の変更
`Upload_WardPress.py` の main関数内で以下の行を変更：

```python
# 各銘柄のチャートを生成（最大10銘柄まで）
for i, ticker in enumerate(range_break_tickers[:10]):  # 10を変更
```

### チャートの期間変更
`load_stock_data` 関数内で以下の行を変更：

```python
# 最新のデータから過去60日分を取得
df = df.sort_values('Date').tail(60)  # 60を変更
```

### チャートのスタイル変更
`generate_chart` 関数内でチャートの見た目をカスタマイズできます。

## 注意事項

- 初回実行時は必要なパッケージのインストールに時間がかかる場合があります
- チャート生成により投稿処理時間が長くなる可能性があります
- 大量の銘柄がある場合、処理時間が長くなる可能性があります
- チャート生成に失敗しても既存機能は正常に動作します

## トラブルシューティング

### チャートが生成されない場合
1. 必要なパッケージがインストールされているか確認
2. TechnicalSignalフォルダに株価データファイルが存在するか確認
3. company_list_20250426.csvファイルが存在するか確認

### エラーメッセージの確認
コンソールに出力されるエラーメッセージを確認し、該当するファイルやデータの存在を確認してください。

